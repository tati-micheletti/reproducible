<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Repeatability-safe install and load packages, optionally with specific versions — Require • reproducible</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Repeatability-safe install and load packages, optionally with specific versions — Require" />

<meta property="og:description" content="This is an &quot;all in one&quot; function that will run install.packages for
CRAN packages, remotes::install_github for GitHub.com packages and
will install specific versions of each package if there is a
packageVersionFile supplied. Plus, when packages is provided as
a character vector, or a packageVersionFile is supplied, all package
dependencies will be first assessed for unique(dependencies) so the
same package is not installed multiple times. Finally library is
called on the packages. If packages are already installed
(packages supplied), and their version numbers are exact (when
packageVersionFile is supplied), then the &quot;install&quot; component will be
skipped very quickly with a message." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-58633549-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-58633549-5');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">reproducible</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Intro-to-Cache.html">Introduction to Cache</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/PredictiveEcology/reproducible">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Repeatability-safe install and load packages, optionally with specific versions</h1>
    <small class="dont-index">Source: <a href='https://github.com/PredictiveEcology/reproducible/blob/master/R/packages.R'><code>R/packages.R</code></a></small>
    <div class="hidden name"><code>Require.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This is an "all in one" function that will run <code>install.packages</code> for
CRAN packages, <code><a href='https://www.rdocumentation.org/packages/remotes/topics/install_github'>remotes::install_github</a></code> for <a href='GitHub.com'>GitHub.com</a> packages and
will install specific versions of each package if there is a
<code>packageVersionFile</code> supplied. Plus, when <code>packages</code> is provided as
a character vector, or a <code>packageVersionFile</code> is supplied, all package
dependencies will be first assessed for <code><a href='https://www.rdocumentation.org/packages/base/topics/unique'>unique(dependencies)</a></code> so the
same package is not installed multiple times. Finally <code>library</code> is
called on the <code>packages</code>. If packages are already installed
(<code>packages</code> supplied), and their version numbers are exact (when
<code>packageVersionFile</code> is supplied), then the "install" component will be
skipped very quickly with a message.</p>
    
    </div>

    <pre class="usage"><span class='fu'>Require</span>(<span class='no'>packages</span>, <span class='no'>packageVersionFile</span>, <span class='kw'>libPath</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/libPaths'>.libPaths</a></span>()[<span class='fl'>1</span>],
  <span class='kw'>install_githubArgs</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(), <span class='kw'>install.packagesArgs</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(),
  <span class='kw'>standAlone</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>repos</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/options'>getOption</a></span>(<span class='st'>"repos"</span>), <span class='kw'>forget</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>packages</th>
      <td><p>Character vector of packages to install via
<code>install.packages</code>, then load (i.e., with <code>library</code>). If it is
one package, it can be unquoted (as in <code>require</code>)</p></td>
    </tr>
    <tr>
      <th>packageVersionFile</th>
      <td><p>If provided, then this will override all <code>install.package</code>
calls with <code><a href='https://www.rdocumentation.org/packages/versions/topics/install.versions'>versions::install.versions</a></code></p></td>
    </tr>
    <tr>
      <th>libPath</th>
      <td><p>The library path where all packages should be installed, and looked for to load
(i.e., call <code>library</code>)</p></td>
    </tr>
    <tr>
      <th>install_githubArgs</th>
      <td><p>List of optional named arguments, passed to <code>install_github</code>.</p></td>
    </tr>
    <tr>
      <th>install.packagesArgs</th>
      <td><p>List of optional named arguments, passed to <code>install.packages</code>.</p></td>
    </tr>
    <tr>
      <th>standAlone</th>
      <td><p>Logical. If <code>TRUE</code>, all packages will be installed and loaded strictly
from the <code>libPaths</code> only. If <code>FALSE</code>, all <code>.libPaths</code> will
be used to find the correct versions. This can be create dramatically faster
installs if the user has a substantial number of the packages already in their
personal library. In the case of <code>TRUE</code>, there will be a hidden file
place in the <code>libPath</code> directory that lists all the packages
that were needed during the <code>Require</code> call. Default <code>FALSE</code> to
minimize package installing.</p></td>
    </tr>
    <tr>
      <th>repos</th>
      <td><p>The remote repository (e.g., a CRAN mirror), passed to either
<code>install.packages</code>, <code>install_github</code> or <code>installVersions</code>.</p></td>
    </tr>
    <tr>
      <th>forget</th>
      <td><p>Internally, this function identifies package dependencies using a memoised
function for speed on reuse. But, it may be inaccurate in some cases,
if packages were installed manually by a user. Set this to <code>TRUE</code> to
refresh that dependency calculation.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>standAlone</code> will either put the <code>Require</code>d packages and their
dependencies <em>all</em> within the libPath (if <code>TRUE</code>) or if
<code>FALSE</code> will only install packages and their dependencies that are
otherwise not installed in <code><a href='https://www.rdocumentation.org/packages/base/topics/libPaths'>.libPaths()</a></code>, i.e., the personal or base
library paths. Any packages or dependencies that are not yet installed will
be installed in <code>libPath</code>. Importantly, a small hidden file (named
<code>._packageVersionsAuto.txt</code>) will be saved in <code>libPath</code> that will
store the <em>information</em> about the packages and their dependencies, even
if the version used is located in <code><a href='https://www.rdocumentation.org/packages/base/topics/libPaths'>.libPaths()</a></code>, i.e., not the
<code>libPath</code> provided. This hidden file will be used if a user runs
<code>pkgSnapshot</code>, enabling a new user to rebuild the entire dependency
chain, without having to install all packages in an isolated directory (as
does <span class="pkg">packrat</span>). This will save potentially a lot of time and disk space,
and yet maintain reproducibility. <em>NOTE</em>: since there is only one hidden
file in a <code>libPath</code>, any call to <code>pkgSnapshot</code> will make a snapshot
of the most recent call to <code>Require</code>.</p>
<p>To build a snapshot of the desired packages and their versions, first run
<code>Require</code> with all packages, then <code>pkgSnapshot</code>. If a
<code>libPath</code> is used, it must be used in both functions.</p>
<p>This function works best if all required packages are called within one
<code>Require</code> call, as all dependencies can be identified together, and all
package versions will be saved automatically (with <code>standAlone = TRUE</code>
or <code>standAlone = FALSE</code>), allowing a call to <code>pkgSnapshot</code> when a
more permanent record of versions can be made.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This function will use <code>memoise</code> internally to determine the
  dependencies of all <code>packages</code>. This will speed up subsequent calls to
  <code>Require</code> dramatically. However, it will not take into account version
  numbers for this memoised step. If package versions are updated manually by
  the user, then this cached element should be wiped, using <code>forget =
  TRUE</code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'># simple usage, like conditional install.packages then library</span>
<span class='fu'>Require</span>(<span class='st'>"stats"</span>) <span class='co'># analogous to require(stats), but slower because it checks for</span>
                 <span class='co'>#   pkg dependencies, and installs them, if missing</span>
<span class='no'>tempPkgFolder</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/file.path'>file.path</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempdir</a></span>(), <span class='st'>"Packages"</span>)

<span class='co'># use standAlone, means it will put it in libPath, even if it already exists</span>
<span class='co'>#   in another local library (e.g., personal library)</span>
<span class='fu'>Require</span>(<span class='st'>"crayon"</span>, <span class='kw'>libPath</span> <span class='kw'>=</span> <span class='no'>tempPkgFolder</span>, <span class='kw'>standAlone</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'># make a package version snapshot</span>
<span class='no'>packageVersionFile</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/file.path'>file.path</a></span>(<span class='no'>tempPkgFolder</span>, <span class='st'>".packageVersion.txt"</span>)
<span class='fu'><a href='pkgSnapshot.html'>pkgSnapshot</a></span>(<span class='kw'>libPath</span><span class='kw'>=</span><span class='no'>tempPkgFolder</span>, <span class='no'>packageVersionFile</span>)

<span class='co'># confirms that correct version is installed</span>
<span class='fu'>Require</span>(<span class='st'>"crayon"</span>, <span class='kw'>packageVersionFile</span> <span class='kw'>=</span> <span class='no'>packageVersionFile</span>)

<span class='co'># Create mismatching versions -- desired version is older than current installed</span>
<span class='co'># This will try to install the older version, overwriting the newer version</span>
<span class='no'>desiredVersion</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame</a></span>(<span class='kw'>instPkgs</span><span class='kw'>=</span><span class='st'>"crayon"</span>, <span class='kw'>instVers</span> <span class='kw'>=</span> <span class='st'>"1.3.2"</span>, <span class='kw'>stringsAsFactors</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/write.table'>write.table</a></span>(<span class='kw'>file</span> <span class='kw'>=</span> <span class='no'>packageVersionFile</span>, <span class='no'>desiredVersion</span>, <span class='kw'>row.names</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='co'># won't work because newer crayon is loaded</span>
<span class='fu'>Require</span>(<span class='st'>"crayon"</span>, <span class='kw'>packageVersionFile</span> <span class='kw'>=</span> <span class='no'>packageVersionFile</span>)

<span class='co'># unload it first</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/detach'>detach</a></span>(<span class='st'>"package:crayon"</span>, <span class='kw'>unload</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'># run again, this time, correct "older" version installs in place of newer one</span>
<span class='fu'>Require</span>(<span class='st'>"crayon"</span>, <span class='kw'>packageVersionFile</span> <span class='kw'>=</span> <span class='no'>packageVersionFile</span>)

<span class='co'># Mutual dependencies, only installs once -- e.g., httr</span>
<span class='fu'>Require</span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"cranlogs"</span>, <span class='st'>"covr"</span>), <span class='kw'>libPath</span> <span class='kw'>=</span> <span class='no'>tempPkgFolder</span>)
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Eliot J B McIntire, Alex M Chubaty.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

